- [会议目的](#会议目的)
- [会议进行](#会议进行)
- [会议内容](#会议内容)
    - [sonar审查规范(代码规范)](#sonar审查规范(代码规范))
    - [mysql建表规范](#mysql建表规范)
    - [redis数据格式规范](#redis数据格式规范)
    - [公司二方库规范](#公司二方库规范)
    - [配套文档及内部培训](#配套文档及内部培训)
    - [技术债务总结](#技术债务总结)
# 会议目的
- 让更多的人做对的事
    - 推广优秀的技术实践
    - 分享踩过的坑，防止错误的重复
- 技术规范等级
    - **规范**：规范做法，必须按照规范要求执行
    - **可选**：可选择的技术做法
    - **推荐**：推荐做法，未经充分验证
    - **有疑问**：做法可能有潜在问题，未经充分验证
    - **警告**：做法有潜在问题，若存在现有系统中，属于技术债务，需尽快修改
    - **禁止**：禁止的做法，须立即修改

# 会议进行
- 每两周的周五：下午三点至五点
- 参会人员控制在15人左右
- 会议需要有记录人员，整理会议纪要，并在会议后将议定的规范归档（文档形式待定）
- 每次会议前准备好待讨论的内容
- 每次会议最后确定下一次会议的主题

# 会议内容
- sonar审查规范
- mysql建表规范
- redis数据格式规范
- 公司内部库：二方库的规范（配合maven与nexus），工具类、项目原型的建立
- 配套文档以及内部培训
- 技术债务总结（暂定）

## sonar审查规范(代码规范)
- FindBugs+Sonar way
    - 251 active rules
    - 74 Bug
    - 16 Vulnerability
    - 161 Code Smell
- 对规则做加法: [选择添加的规则](http://10.108.26.211/coding_rules#activation=false|qprofile=java-sonar-way-44555)
- 对规则做减法：[决定不需要的规则](http://10.108.26.211/coding_rules#activation=true|qprofile=java-sonar-way-44555)
---

## mysql建表规范
- **规范**：表名、字段名小写，以下划线分隔
- **规范**：每张表都需要有id字段做自增主键，无任何业务意义，类型为int或bigint，位置放第一个
> 解释：int的自增主键可以增加数据操作的性能。
- **规范**：表字段顺序问题：被用作索引的字段靠前，唯一索引字段在最前的位置（仅次于id）
> 解释：可以一目了然看出某张表所代表的实体，及其唯一标识。
- **推荐**：表有关联关系时，关联字段的名称相同
> 解释：方便未来进行的自动化DAO层开发，指定关联的表可以智能决定关联字段--约定大于配置。
- 有业务属性的唯一标识如何命名：user_id,order_code,type_key...建议统一使用"***_id"的形式
> 解释：统一规范。
- **可选**：一些复杂的业务数据可以使用json格式存入某个字段中（5.7版本的mysql已经支持JSON格式字段）
> 解释：一些难以归一化的数据，例如第三方回调信息，套题信息，单独建表表结构不好定义，使用json格式可以简化表结构。但注意只提供数据展示功能，需要按json中某个字段查找时要考虑效率问题，或者将该查找字段提取出来作为新的字段。
- **可选**：频繁更新业务状态的表，例如订单、仓储、系统参数，需要有一个对应的只做插入操作的历史记录表，方便对历史数据做快照和回溯
- **可选**: 存储过程慎用，虽然方便修改但也有维护难，定位问题不方便的问题。使用视具体项目情况而定。
- **推荐**：表字段名称尽量简短，可以使用简写的尽量简写。
- **规范**：建表范例，一些通用字段的确立，（待完成，将指派各项目经理制定，在下次会议上集中讨论）
- **规范**：布尔意义的字段使用tinyint的数据类型，并且定义为0和1（对应否和是），需要有默认值。
---

## redis数据格式规范
- **规范**：redis库须有访问密码
> 解释：安全考虑，redis密码要设的尽量复杂。
- **规范**：key名称要有命名空间的概念，以冒号“:”分隔，例如boss:crm:user_K:9ZI1jKqcRcfT5F9i
> 解释：防止key名称的污染，方便后期维护。在Redis Desktop Manager中，默认使用“:”作为命名空间的分隔符，所有key将按层级展现。
- **禁止**：禁止直接使用类似"9ZI1jKqcRcfT5F9i"这样无意义的名称作为key值
- **规范**：key名称的命名空间前缀小写
- **规范**：key名称的后缀表示redis数据格式
    - _K:字符串，建议value以json格式保存，对应get ，set等操作
    - _H:HashMap，即value也是键值对，对应hget, hset等操作
    - _L:List列表，value为列表，对应lpop，lpush等操作
    - _S:Set无序集合，valie为集合，对应sadd，smembers等操作
    - _Z:Set有序集合，对应zadd，zrangebyscore等操作
- **可选**：一些配置常量，如菜单配置，人员权限，系统参数可以放入redis中，方便快速查询，注意更新时也要同步更新redis。
- redis培训（待完成，将放入下期培训计划中）
---

## 公司二方库规范
- 版本目前统一为SNAPSHOT
- 需要有公共的工具包
- 业务相关性的特有的工具包和公共组件将指派专人去整理和维护
---

## 配套文档及内部培训
- 新员工培训，将定期组织新员工培训，整理完善的工具包、ppt和文档包（待完成）
- 完善公司wiki，将建立总体的wiki目录，具体的内容会指派专人去编写。
- 考虑使用爬虫丰富wiki内容。
- 考虑举办内部研发竞赛，将有物质形式奖励。
---

## 技术债务总结
- 后端接口改版，需要独立的接口鉴权，用户登录验证将不需要PC或WAP端做。配合新的纯JS前端，单纯使用JS访问接口。(优先级：高)
- 图片服务器改版，对图片的操作功能（裁剪，缩放，加水印）；批量上传；上传速度慢的问题；进度条功能。（优先级：低）

## 下次会议内容
- 具体的java编码规范
- 配置文件规范